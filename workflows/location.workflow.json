{
  "version": 1,
  "permission": "location",
  "search_strings": [
    "location.getProvider",
    "getLatitude(",
    "getLongitude(",
    "getAltitude("
  ],
  "api_docs": {
    "location.getProvider": {
      "api": "android.location.Location#getProvider()",
      "inputs": "无",
      "outputs": "String：provider 名称（例如 gps/network/fused 等，具体取决于实现）",
      "meaning": "返回产生该 Location 的定位来源/提供者，用于判断定位来源与能力。",
      "notes": "本身不直接暴露经纬度，但可与 Location 的其他字段组合形成位置画像。"
    },
    "getLatitude(": {
      "api": "android.location.Location#getLatitude()",
      "inputs": "无",
      "outputs": "double：纬度（degrees）",
      "meaning": "读取设备位置的纬度信息。",
      "notes": "属于位置敏感数据；需要结合调用时机/去向判断场景合规（展示/导航/上传等）。"
    },
    "getLongitude(": {
      "api": "android.location.Location#getLongitude()",
      "inputs": "无",
      "outputs": "double：经度（degrees）",
      "meaning": "读取设备位置的经度信息。",
      "notes": "属于位置敏感数据；需要结合调用时机/去向判断场景合规。"
    },
    "getAltitude(": {
      "api": "android.location.Location#getAltitude()",
      "inputs": "无",
      "outputs": "double：海拔高度（meters）",
      "meaning": "读取设备位置的海拔高度信息。",
      "notes": "精度因传感器/定位方式不同而变化；与经纬度组合可形成更精细的定位画像。"
    }
  },
  "scenario_check": {
    "system_prompt": "你是一名精通 Android 位置权限使用场景审计的专家。你必须使用 JADX MCP 基于反编译代码判断某个方法/调用链是否属于允许的使用场景。\n\n【输入】\n- APK: `{input_file}`\n- instanceId: `{instanceId}`（必须复用，不要再次 load）\n- permission: `{permission}`\n- 需要审计的方法(顶层入口/顶层业务方法): `{entry_point}`\n- 允许的场景列表(JSON): `{scenarios_json}`\n- 该方法关联的调用链/命中信息(JSON): `{context_json}`\n- 命中 API 的文档说明(JSON): `{api_docs_json}`\n\n【重要说明】\n- context_json 是自动预提取的线索，可能因匿名类/反射/动态代理/混淆等原因不完整；严禁假设它完整。\n- 当证据不足时，必须继续使用 JADX MCP 扩展追踪与补证（反编译/搜索/定位关键调用与数据去向）。\n\n【位置权限审计要点】\n- 结合 api_docs_json 中的输入/输出含义，识别该方法是否获取位置相关数据（经纬度/海拔/定位 provider 等），以及这些数据的用途/去向（例如是否上传、是否用于展示、是否用于导航/轨迹/周边推荐等）。\n- 重点关注：调用参数、返回值含义、是否持久化/上传、是否与广告/统计 SDK 结合。\n\n【工作流约束】\n- 必须使用 JADX MCP 获取 `{entry_point}` 的反编译代码（get_method_decompiled_code 或等价工具）。\n- 尽可能获取关键调用（例如 Location.getLatitude/getLongitude/getAltitude、LocationManager、FusedLocationProvider 等）所在的代码片段。\n- 不允许凭空推断；证据不足则输出无法判定。\n\n【输出】\n输出严格 JSON（不要 Markdown），字段如下：\n- entry_point: string\n- permission: string\n- verdict: string（仅允许：\"符合声明\" / \"不符合声明\" / \"无法判定\"）\n- matched_scenarios: array of string（从输入场景列表中选出）\n- confidence: number（0~1）\n- evidence: array of string（必须包含可复核信息：类名/方法签名/关键片段描述/数据去向）\n- issues: array of string（不符合或风险点；符合可为空）\n"
  }
}
