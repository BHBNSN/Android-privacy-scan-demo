{
  "version": 1,
  "name": "Check.ScenarioComplianceJadx",
  "description": "从一个顶层入口方法出发，结合预提取调用链线索与反编译证据，判定权限调用是否符合外部声明的使用场景。",
  "phases": {
    "scan": {
      "goal": "从单个 entry_point 出发，进行权限使用场景合规审计",
      "inputs": ["entry_point"],
      "method": "scenario_compliance_check",
      "rules": [
        "只分析这一个 entry_point：{entry_point}",
        "必须先 load(input_file) 并记录 instanceId",
        "必须使用 JADX/MCP 获取 entry_point 的反编译代码（get_method_decompiled_code 或等价工具）",
        "如果反编译失败，必须尝试用“列出类方法/搜索签名/纠正类名”的方式修正 entry_point；若工具不可用则输出无法判定并说明原因",
        "context_json/预提取调用链可能不完整；不得假设完整，必要时必须用 JADX/MCP 扩展补证",
        "必须给出可复核的证据：关键代码片段 + 关键敏感 API 调用 + 数据去向/触发条件"
      ],
      "output": {
        "format": "json",
        "schema": {
          "entry_point": "string",
          "verdict": "string",
          "confidence": "number",
          "evidence": ["string"],
          "issues": ["string"],
          "key_snippet": "string"
        }
      }
    }
  }
}
